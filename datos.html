<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menú Responsive</title>
    <link rel="stylesheet" href="estilomenu.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <input type="checkbox" id="check">
        <label for="check" class="checkbtn">
            <i class="fas fa-bars"></i>
        </label>
        <a href="#" class="enlace">
            <img src="images/logo.png" alt="" class="logo">
        </a>
        <ul>
            <li><a class="active" href="menu.html">Inicio</a></li>
            <li><a href="#">Mis Datos</a></li>
            <li><a href="pedidos.html">Mis Pedidos</a></li>
            <li><a href="menu.html">Populares</a></li>
            <li><a href="index.html">Cerrar Sesion</a></li>
        </ul>
    </nav>
    <section class="form-register" >
        <h4>Datos del Usuario</h4>
        <input class="controls" type="text" name="nombres" id="nombres" placeholder="Nombre">
        <input class="controls" type="text" name="apellidos" id="apellidos" placeholder="Apellido">
        <input class="controls" type="email" name="correo" id="correo" placeholder="Correo">
        <input class="controls" type="text" name="correo" id="contra" placeholder="Contraseña">
        <input class="controls" type="text" name="direccion" id="direccion" placeholder="direccion">
        <input class="botons" type="submit" value="Actualizar" id="button" data-accion="modificar">
    </section>
    <script>
        window.onload = function cargarcomentarios(){
    $.get("http://localhost:3001/consultar-usuario",(respuesta, status)=>{
                        if(respuesta.resp.length>0){

                            respuesta.resp.forEach(usuarios => {
                                if(usuarios.id_usuarios==localStorage.getItem("id")){
                                    document.getElementById("nombres").value = usuarios.nombre;
                                    document.getElementById("apellidos").value = usuarios.apellido;
                                    document.getElementById("correo").value = usuarios.correo;
                                    document.getElementById("contra").value = usuarios.contra;
                                    document.getElementById("direccion").value = usuarios.direccion;
                                }
                                
                                
                    });
                    }else{
                    $("#msgComentario")
                            .removeClass("alert-success")
                            .addClass("alert-danger");
                    }
                    setTimeout(()=>{
                        $("#msgComentario").addClass("d-none");
                    },5000);
                    }, "json");
    }
    document.getElementById("button").addEventListener("click",()=>{
    
        let accion = $("#button").data("accion"),
        id_usuarios = localStorage.getItem("id");
        nombre = $("#nombres").val(),
        apellido = $("#apellidos").val();
        correo = $("#correo").val(),
        contra = $("#contra").val(),
        direccion = $("#direccion").val();
        datos = {accion, nombre, apellido, correo, contra, direccion, id_usuarios};
        $.post("http://localhost:3001/usuario",JSON.stringify(datos), (respuesta, status)=>{

            $("#msgComentario").removeClass("d-none").text(respuesta.resp);

            if( respuesta.resp.indexOf("exito") >=0 ){
            
                $("#msgComentario")
                    .removeClass("alert-danger")
                    .addClass("alert-success");
            } else {
                $("#msgComentario")
                    .removeClass("alert-success")
                    .addClass("alert-danger");
            }
            setTimeout(()=>{
                $("#msgComentario").addClass("d-none");
            },5000);
            }, "json");
            });
    </script>
    <script src="js/jquery.js"></script>
    <script src="js/script.js"></script>
</body>
</html>